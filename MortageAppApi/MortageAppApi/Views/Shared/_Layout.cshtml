<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width = device-width,initial-
          scale = 1" />

    <title>
        Mortàge
    </title>

    <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="style/main.css" />

    <style>
        #top {
            height: 1200px;
            width: 100%;
            margin-left: auto;
            margin-right: auto;
        }

        #info {
            background-color: white;
        }

        #left {
            float: left;
        }

        #leftTable {
            float: left;
            background-color: white;
            width: 40%;
        }

        #right {
            float: right;
            background-color: white;
        }

        #rightTable {
            float: right;
            background-color: white;
            width: 40%;
        }

        #bottomTable {
            background-color: white;
        }

        #image {
            height: 160px;
            width: 100%;
        }

        #foot {
            position: absolute;
            width: 100%;
            margin-top: 40px;
        }

        #applyLeft {
            float: left;
            width: 50%;
        }

        #applyRight {
            float: right;
            width: 50%;
        }

        #titlError, #descError, #errorSSN, #errorMT, .addressError {
            color: orangered;
        }

        #cancelPayment {
            float: right;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

    <script>


        function fillData() {


            document.getElementById("welcome").innerHTML = "Welcome Back, " + sessionStorage.getItem('userName');
            document.getElementById("accountInfo").innerHTML = "Total Balance: $" + 4200.23 + "< br /> Number of Mortgages: " + 33 + "< br /> Active Cases: " + 33;



        }

        function killSession() {

            sessionStorage.clear();

        }


        function loadHome() {
            $(document).ready(function () {
                $('#mortgage').slideUp(500);
                $('#home').slideDown(500);
                $('#service').slideUp(500);
                $('#apply').slideUp(500);
                $('#help').slideUp(500);

            });
        }
        function loadMortgage() {
            $(document).ready(function () {
                $('#mortgage').slideDown(500);
                $('#home').slideUp(500);
                $('#service').slideUp(500);
                $('#apply').slideUp(500);
                $('#help').slideUp(500);

            });
        }
        function loadApply() {
            $(document).ready(function () {
                $('#mortgage').slideUp(500);
                $('#home').slideUp(500);
                $('#service').slideUp(500);
                $('#apply').slideDown(500);
                $('#help').slideUp(500);

            });
        }
        function loadService() {
            $(document).ready(function () {
                $('#mortgage').slideUp(500);
                $('#home').slideUp(500);
                $('#service').slideDown(500);
                $('#apply').slideUp(500);
                $('#help').slideUp(500);


            });
        }

        function loadHelp() {
            $(document).ready(function () {
                $('#mortgage').slideUp(500);
                $('#home').slideUp(500);
                $('#service').slideUp(500);
                $('#apply').slideUp(500);
                $('#help').slideDown(500);

            });
        }


        function caseValidate() {
            var titl = document.getElementById("titl").value;
            var desc = document.getElementById("desc").value;
            var logi = false;
            var titb = false;
            var dscb = false;



            if (titl == "") {
                titb = false;
                $(document).ready(function () {
                    $('#titlError').show(500);

                });

            }
            else {
                titb = true;
                $(document).ready(function () {
                    $('#titlError').hide(500);

                });
            }

            if (desc == "") {
                dscb = false;
                $(document).ready(function () {
                    $('#descError').show(500);

                });


            }
            else {
                dscb = true;
                $(document).ready(function () {
                    $('#descError').hide(500);

                });

            }

            if (dscb && titb) {
                return true;
            }
            else {
                return false;
            }

        }

        function caseSubmit() {
            caseValidate();

            if (caseValidate()) {
                var Case = {
                    "Case": [

                        {
                            "Mortgage": document.getElementById("titl").value,
                            "caseDescription": document.getElementById("desc").value
                        }
                    ]
                };
                console.log(Case);
            }

        }

        function payment() {
            $(document).ready(function () {
                $('#rTable').slideUp(500);
                $('#makePayment').slideDown(500);
            });
        }

        function cancelPayment() {
            $(document).ready(function () {
                $('#makePayment').slideUp(500);
                $('#rTable').slideDown(500);
            });
        }
        function reason() {
            $(document).ready(function () {
                $('#lTable').slideUp(500);
                $('#reason').slideDown(500);
            });
        }

        function cancelReason() {
            $(document).ready(function () {
                $('#reason').slideUp(500);
                $('#lTable').slideDown(500);
            });
        }

        function openCase() {
            $(document).ready(function () {
                $('#caseTable').slideUp(500);
                $('#case').slideDown(500);
            });
        }

        function closeCase() {
            $(document).ready(function () {
                $('#caseTable').slideDown(500);
                $('#case').slideUp(500);
            });
        }












        //Mortgage Apply form validation



        function checkAmount() {
            var amount = document.getElementById("applicationAmount").value;


            if (Number(amount) < 1000) {
                document.getElementById("applicationAmount").value = 1000;
            }
        }

        function checkSSN() {
            var SSN = document.getElementById("SSN").value;

            var ssnPattern = /^[0-9]{3}\-?[0-9]{2}\-?[0-9]{4}$/;
            if (!ssnPattern.test(SSN)) {
                $(document).ready(function () {
                    $('#errorSSN').slideDown(500);
                });
                document.getElementById("SSN").value = "";
                return false;
            }
            else {
                $(document).ready(function () {
                    $('#errorSSN').slideUp(500);
                });
                return true;
            }

        }

        function checkTitle() {

            var title = document.getElementById("mortgageTitle").value;

            if (title === "") {
                $(document).ready(function () {
                    $('#errorMT').slideDown(500);
                });
                return false;
            }
            else {
                $(document).ready(function () {
                    $('#errorMT').slideUp(500);
                });
                return true;
            }
        }

        function checkAddress() {
            var fname = document.getElementById("first-name").value;
            var lname = document.getElementById("last-name").value;
            var line1 = document.getElementById("address-line1").value;
            var city = document.getElementById("city").value;
            var regin = document.getElementById("region").value;
            var zip = document.getElementById("postal-code").value;

            if (fname === "" || lname === "" || line1 === "" || city === "" || regin === "" || zip === "") {
                $(document).ready(function () {
                    $('.addressError').slideDown(500);
                });
                return false;
            }
            else {
                $(document).ready(function () {
                    $('.addressError').slideUp(500);
                });
                return true;
            }

        }


        function applyValidate() {
            checkAmount();
            checkSSN();
            checkTitle();
            checkAddress();
            if (checkSSN() & checkTitle() & checkAddress()) {
                {

                    //checks if all conditions are evaluating true
                    var Application = {
                        "MortgageApplication":

                            {
                                "ssn": document.getElementById("SSN").value, "currency": document.getElementById("currency").value,
                                "mortgageTitle": document.getElementById("mortgageTitle").value,
                                "amount": document.getElementById("applicationAmount").value, "firstName": document.getElementById("first-name").value,
                                "lastName": document.getElementById("last-name").value, "address1": document.getElementById("address-line1").value,
                                "address2": document.getElementById("address-line2").value, "cityOrTown": document.getElementById("city").value,
                                "stateOrProvince": document.getElementById("region").value, "zip": document.getElementById("postal-code").value,
                                "country": document.getElementById("country").value
                            }
                    };
                    console.log(Application);


                    $.ajax({

                        type: 'POST',

                        url: 'http://mortage.azurewebsites.net/api/application',

                        data: JSON.stringify(Application),

                        contentType: "application/json",

                        dataType: 'JSON',

                        success: function () {

                            console.log("Success");

                        },

                        Error: function () {

                            console.log("ERROR");

                        }

                    });


                }
            }

        }

        function payValidate() {

            var payment = document.getElementById("payment").value;
            if (Number(payment) < 1) {
                document.getElementById("payment").value = 1;
                $(document).ready(function () {
                    $('#paymentError').slideDown(500);
                    $('#paymentError').slideUp(3000);
                });
            }

        }




    </script>

</head>
<body onload="fillData()">
    <img id="image" src="Background.jpg" class="img-fluid" alt="Responsive image">

    <nav class="navbar navbar-inverse">
        <div class="container-fluid">
            <div class="navbar-header">
                <a class="navbar-brand" onclick="loadHome()" href="#">Home</a>
            </div>
            <ul class="nav navbar-nav">
                <li onclick="loadMortgage()"><a href="#">My Mortgages</a></li>
                <li onclick="loadApply()"><a href="#">Apply</a></li>
                <li onclick="loadService()"><a href="#">Customer Service</a></li>
                <li onclick="loadHelp()"><a href="#">Help</a></li>
                <li class="active" id="logout" onlclick="killSession()"><a href="Login.html">Logout</a></li>
            </ul>
        </div>
    </nav>

    <div class="container body-content">
        @RenderBody()
        <hr />
        <footer>
            <p>&copy; @DateTime.Now.Year - Mortàge</p>
        </footer>
    </div>
</body>
</html>
